<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy" crossorigin="anonymous">

    <title>HEXART</title>
  </head>
  <body>
    <div class="container-fluid">

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   viewBox="0 0 2300 450"
   height="450"
   width="2300"
   xml:space="preserve"
   id="svg10"
   version="1.1"
   sodipodi:docname="samson_logo_plain.svg"
   inkscape:version="0.92.2 5c3e80d, 2017-08-06"><sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1628"
     inkscape:window-height="1005"
     id="namedview20"
     showgrid="false"
     inkscape:zoom="0.54214015"
     inkscape:cx="933.67017"
     inkscape:cy="-171.5031"
     inkscape:window-x="52"
     inkscape:window-y="1"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg10" /><metadata
     id="metadata16"><rdf:RDF><cc:Work
         rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><defs
     id="defs14" /><path
     inkscape:connector-curvature="0"
     style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:3.99607944"
     d="m 176.77443,434.04779 c 21.88253,-5.83828 41.84694,-18.02632 59.58154,-36.35234 18.8575,-19.49687 31.42118,-41.30348 37.5112,-65.12411 11.56464,-45.19166 -2.18585,-86.19944 -37.99472,-113.38874 -20.44794,-15.51681 -43.17764,-24.88359 -78.92257,-32.50014 -23.13331,-4.93116 -31.5011,-8.31982 -39.82094,-16.09221 -8.16399,-7.63651 -11.45676,-15.67262 -11.44077,-27.96056 0,-8.45971 0.54347,-10.95726 3.90017,-18.10623 10.27392,-21.85457 31.25334,-33.155491 50.90606,-27.441083 8.17598,2.373662 20.13624,10.881323 25.03544,17.794533 1.95008,2.74932 3.90417,5.01107 4.35572,5.02709 1.57846,0.064 72.82056,-34.310358 73.13226,-35.293393 0.59142,-1.778256 -20.20019,-26.69381 -29.39517,-35.201475 C 184.71863,4.0816268 127.53873,0.38123715 77.012301,39.263108 66.8183,47.099401 51.06975,64.662188 43.840843,76.226825 30.418013,97.737734 23.157137,119.74815 21.958313,142.69362 c -2.437609,46.05084 21.227173,82.71486 67.729551,104.96104 17.370956,8.30384 29.375186,12.11211 55.677376,17.65467 27.24127,5.74237 37.35535,11.39282 43.61321,24.34811 4.29579,8.89927 5.09101,17.06326 2.64141,26.66185 -3.84023,15.00128 -13.28696,26.98952 -26.2902,33.39124 -6.96118,3.43263 -9.39479,3.98009 -17.33899,3.98009 -12.14409,0 -20.97942,-4.15192 -31.51709,-14.84543 l -7.57256,-7.68047 -35.992692,15.37692 c -19.79658,8.44371 -36.496196,15.84445 -37.107597,16.41989 -1.76227,1.68634 11.848376,18.87348 26.773734,33.79484 22.505921,22.5259 42.957855,34.18646 68.820485,39.25749 11.75646,2.31373 32.81181,1.39063 45.37948,-1.96607 z"
     id="path268-3-9" /><path
     inkscape:connector-curvature="0"
     style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:3.99607944"
     d="m 1385.2289,433.58024 c 20.5718,-6.118 37.1035,-16.06024 54.0549,-32.54407 52.4166,-50.92204 60.8004,-122.75557 19.6368,-168.13505 -21.9146,-24.1643 -61.0801,-41.95884 -105.7563,-48.04486 -12.1441,-1.65438 -20.8076,-5.65045 -28.1284,-13.00325 -13.6266,-13.67458 -16.9674,-33.26336 -8.6315,-50.60633 4.1359,-8.63155 15.0172,-18.82555 23.433,-21.978454 8.5676,-3.20085 22.5059,-3.560493 30.4701,-0.763257 10.2379,3.556511 19.0573,11.017211 25.1433,21.211181 0.2519,0.40763 70.8545,-32.10849 74.0234,-34.090543 1.4346,-0.891118 0.4196,-2.857187 -5.135,-10.086104 -32.2523,-41.926872 -68.1691,-62.654531 -108.5055,-62.594579 -17.4948,0.03184 -31.0616,3.248797 -47.8251,11.316904 -40.2725,19.436908 -70.6347,59.741371 -78.3951,104.117842 -9.3788,53.57145 19.0293,99.91797 75.5059,123.19115 14.0662,5.79031 25.2393,9.00715 47.969,13.79845 26.9895,5.68243 37.0556,11.33288 43.4254,24.36809 4.2917,8.7714 5.075,16.79553 2.5775,26.56594 -7.4168,29.01953 -36.0607,45.23962 -60.0811,33.99865 -4.7314,-2.20184 -9.8983,-6.13399 -14.9853,-11.40881 -6.5895,-6.80532 -8.12,-7.83631 -10.1021,-6.78934 -1.2787,0.68333 -17.1871,7.66448 -35.3253,15.48481 -18.1382,7.82032 -33.4672,14.70158 -34.0586,15.28101 -1.6704,1.67036 11.9402,20.01236 24.7557,33.35527 21.5588,22.47795 41.4433,34.35829 66.4987,39.74501 12.6756,2.71334 36.0727,1.59044 49.4356,-2.38966 z"
     id="path270-2-2" /><path
     inkscape:connector-curvature="0"
     style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:3.99607944"
     d="m 783.64702,292.03112 c 0.0318,-167.50766 -0.48352,-159.39164 11.00521,-173.70559 8.64753,-10.80142 19.08927,-16.98334 34.02662,-20.180204 10.3978,-2.217815 11.08512,-2.217815 20.21618,-0.111752 5.19888,1.202813 13.91034,4.419646 19.32503,7.148976 8.95922,4.51159 10.38181,5.74637 15.5168,13.45881 4.51156,6.78933 6.22589,10.97321 8.58357,20.94744 l 2.95308,12.47177 v 283.23799 h 80.98057 V 293.2659 c 0.0159,-133.72881 0.13977,-142.73595 2.30973,-153.86504 2.56148,-13.25499 2.26577,-12.5357 9.66253,-22.25815 6.6055,-8.66351 17.85846,-14.97333 33.43516,-18.765603 10.2899,-2.497544 10.5697,-2.497544 20.6398,-0.279857 14.9214,3.29277 26.5819,10.33387 34.1225,20.60378 10.5976,14.43784 10.19,7.71244 10.238,173.32996 l 0.032,143.26744 h 81.0764 l -0.4355,-151.24362 c -0.3757,-136.09847 -0.6274,-152.14674 -2.4856,-160.40661 -6.118,-27.285238 -16.7475,-47.63727 -34.4941,-66.11916 -11.1171,-11.568649 -20.2642,-18.609721 -32.9397,-25.351132 -22.3181,-11.880344 -40.6441,-16.499806 -65.4958,-16.531771 -18.7935,-0.01592 -31.501,2.093963 -47.84503,7.932221 -16.4199,5.866244 -25.80266,11.392839 -45.42344,26.813682 -2.8412,2.233828 -2.90513,2.201863 -13.61065,-5.89821 -28.05247,-21.247161 -65.77945,-32.420189 -97.37245,-28.847693 -13.41083,1.514509 -13.78649,1.594454 -30.56603,6.369764 -41.51925,11.832396 -77.22023,47.4854 -89.42825,89.332359 -7.32084,25.08738 -7.50865,29.59895 -7.50865,183.13232 0,76.5529 0.35968,139.55109 0.81121,140.00665 0.45557,0.45155 19.23314,0.8112 41.72708,0.8112 h 40.89586 z"
     id="path274-4-8" /><path
     inkscape:connector-curvature="0"
     style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:3.99607944"
     d="m 2085.5578,289.5016 c 0,-161.60546 -0.4835,-151.867 8.084,-166.02113 14.6137,-24.196262 46.0349,-34.266384 70.1192,-22.47796 3.6045,1.76228 10.0702,6.72543 14.3779,11.0332 6.4137,6.41771 8.5676,9.67851 11.9243,17.98235 l 4.092,10.16204 0.3437,147.55923 0.3277,147.55923 h 83.3862 l -0.032,-143.26744 c -0.032,-158.93606 -0.2356,-163.96315 -7.3368,-186.81674 -10.3019,-33.107508 -37.3074,-63.625559 -66.8704,-75.629785 -29.0355,-11.768465 -49.7192,-15.544757 -74.8665,-13.642618 -21.1193,1.610405 -53.3237,13.09914 -72.349,25.818675 -28.3003,18.93743 -49.5315,55.026012 -53.3717,90.711018 -0.8112,7.58454 -1.2787,64.77644 -1.2787,157.37359 v 145.4533 h 83.4501 z"
     id="path276-1-3" /><path
     style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:3.99607944"
     d="M 1736.9336 16.878906 C 1718.8394 16.798986 1697.3758 18.346217 1684.8281 21.015625 C 1609.8217 36.892038 1553.2815 87.154864 1529.7246 158.89648 C 1520.8892 185.80608 1516.7852 215.21605 1518.7832 237.31836 C 1527.4627 332.97252 1587.2197 404.51719 1676.9277 426.60352 C 1685.3714 428.68147 1696.1262 430.86357 1700.8535 431.45898 C 1715.5271 433.30117 1748.4818 433.01574 1762.6719 430.92578 C 1843.6085 419.04545 1905.7838 367.26841 1930.8672 290.85938 C 1938.8753 266.47929 1944.1481 232.96531 1942.6016 216.26172 C 1938.6215 173.11604 1926.6333 137.66835 1905.0625 105.15625 C 1894.1212 88.656408 1869.3935 64.195601 1851.9746 52.626953 C 1824.2019 34.17706 1792.7666 22.56114 1758.3164 18.017578 C 1752.6659 17.266326 1745.1416 16.910904 1736.9336 16.878906 z M 1724.6777 97.316406 C 1726.5727 97.306815 1728.6426 97.308413 1730.9219 97.316406 C 1750.215 97.376346 1753.629 97.720818 1764.5742 100.66992 C 1814.0377 114.00085 1848.2102 151.95135 1858.0605 204.50781 C 1865.1616 242.43859 1850.2894 288.30228 1821.8652 316.03906 C 1794.576 342.66895 1754.5239 356.1725 1715.75 351.80078 C 1667.1736 346.33814 1626.5846 315.39943 1609.9609 271.13086 C 1601.0337 247.38616 1598.8185 224.1913 1603.3301 202.04102 C 1614.0555 149.45261 1648.3287 112.80477 1698.8711 99.941406 C 1706.7244 97.948348 1711.4131 97.383545 1724.6777 97.316406 z "
     id="path35" /><path
     style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:3.99607944"
     d="M 471.70117 15.568359 C 463.741 15.520289 456.01519 16.147556 448.91016 17.490234 C 422.564 22.485355 399.27406 34.142931 380.04492 51.9375 C 355.69281 74.479362 341.84504 102.87031 337.61719 138.96289 C 336.03877 152.36976 335.72461 177.09622 335.72461 294.28125 C 335.72461 370.93806 336.08715 434.03238 336.55469 434.50391 C 337.00626 434.95548 355.9264 435.18941 378.57617 435.01758 L 419.76562 434.68555 L 420.09766 392.65039 L 420.41016 350.63086 L 529.59766 350.63086 L 529.59766 435.29688 L 611.81641 435.29688 L 611.76953 290.81641 C 611.75285 209.97174 611.22178 140.91808 610.56641 134.04883 C 606.57035 91.778318 581.54657 55.263952 541.07031 32.662109 C 521.85313 21.936629 495.63369 15.724205 471.70117 15.568359 z M 475.01367 96.425781 C 477.61909 96.457541 480.25493 97.098555 485.42188 98.361328 C 499.95562 101.9378 510.91418 108.35187 517.85938 117.375 C 524.79255 126.39816 525.35252 127.7894 527.74219 142.02344 C 529.38058 151.78187 529.63176 163.06863 529.33203 211.36523 L 528.97266 269.02344 L 474.6875 269.34961 L 420.38086 269.66602 L 420.38086 209.22461 C 420.38086 135.49692 420.81335 131.5973 430.67969 118.40625 C 438.46803 107.98049 449.30498 101.5127 464.75781 98.080078 C 469.83285 96.957162 472.40424 96.393807 475.01367 96.425781 z "
     id="path30" /></svg> 

      <input id="color8" type="color">
      <input id="color7" type="color">
      <input id="color6" type="color">
      <input id="color5" type="color">
      <input id="color4" type="color">
      <input id="color3" type="color">

 
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="home-tab" data-toggle="tab" href="#rainbow" role="tab">Rainbow</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="profile-tab" data-toggle="tab" href="#colorwipe" role="tab" >Pixel Wipe</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="contact-tab" data-toggle="tab" href="#letterwipe" role="tab">Letter Wipe</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="contact-tab" data-toggle="tab" href="#random" role="tab">Random</a>
        </li> 
        <li class="nav-item">
          <a class="nav-link" id="contact-tab" data-toggle="tab" href="#randomLetter" role="tab">Random Letter</a>
        </li>               
      </ul>
          <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="rainbow" role="tabpanel">
              <form>
                <br>
                <input type="number" class="form-control" id="rainbowWait" min="1" max="255" value="50">
                <small  class="form-text text-muted">Smaller wait means faster animation.</small>
                <br>
                <button type="button" class="btn btn-primary btn-block" id="rainbowStart">Start</button>
              </form>
            </div>
            <div class="tab-pane fade" id="colorwipe" role="tabpanel" >
              <form>
                <br>
                <input type="number" class="form-control" id="colorWipeWait" min="1" max="255" value="50">
                <small id="waitHelp" class="form-text text-muted">Smaller wait means faster animation.</small>
                <br>
                <div class="row">
                    <div class="col-sm-4">
                      <input id="colorWipe1" type="color"/> <br>
                      <small class="form-text text-muted">First color.</small>      
                    </div>
                    <div class="col-sm-4">
                      <input id="colorWipe2" type="color"/> <br>
                      <small class="form-text text-muted">Second color.</small>
                    </div>
                    <div class="col-sm-4">
                      <input id="colorWipe3" type="color"/> <br>
                      <small class="form-text text-muted">Third color.</small>
                    </div>
                </div>  
                <br>              
                <button type="button" class="btn btn-primary btn-block" id="colorWipeStart">Start</button>
              </form>              

            </div>
            <div class="tab-pane fade" id="letterwipe" role="tabpanel">
              <form>
                <br>
                <input type="number" class="form-control" id="letterWipeWait" min="1" max="255" value="50">
                <small class="form-text text-muted">Smaller wait means faster animation. Value (milliseconds) is multiplied by 4.</small>
                <br>
                <div class="row">
                    <div class="col-sm-4">
                      <input id="letterWipe1" type="color"/> <br>
                      <small id="waitHelp" class="form-text text-muted">First color.</small>      
                    </div>
                    <div class="col-sm-4">
                      <input id="letterWipe2" type="color"/> <br>
                      <small id="waitHelp" class="form-text text-muted">Second color.</small>
                    </div>
                    <div class="col-sm-4">
                      <input id="letterWipe3" type="color"/> <br>
                      <small id="waitHelp" class="form-text text-muted">Third color.</small>
                    </div>
                </div>  
                <br> 
                <button type="button" class="btn btn-primary btn-block" id="letterWipeStart">Start</button>
              </form>              
            </div>
            <div class="tab-pane fade" id="random" role="tabpanel">
              <form>
                <br>
                <input type="number" class="form-control" id="randomWait" min="1" max="255" value="50">
                <small class="form-text text-muted">Smaller wait means faster animation.</small>
                <br> 
                <button type="button" class="btn btn-primary btn-block" id="randomStart">Start</button>
              </form>              
            </div>  
            <div class="tab-pane fade" id="randomLetter" role="tabpanel">
              <form>
                <br>
                <input type="number" class="form-control" id="randomLetterWait" min="1" max="255" value="50">
                <small class="form-text text-muted">Smaller wait means faster animation.</small>
                <br> 
                <button type="button" class="btn btn-primary btn-block" id="randomLetterStart">Start</button>
              </form>              
            </div>                       

      </div>      

    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js" integrity="sha384-a5N7Y/aK3qNeh15eJKGWxsqtnX/wWdSZSKp+81YjTmS15nvnvxKHuzaWwXHDli+4" crossorigin="anonymous"></script>
    <script> 
      var pathMap = {
        "8" : ['path847'],
        "7" : ['path128'],
        "6" : ['path130'],
        "5" : ['path132'],
        "4" : ['path134'],
        "3" : ['path136']
      };

      $().ready(function() {
        console.log("ready. go change the world.");

        checkToken();

        Object.keys(pathMap).forEach(key => {
          $('#color'+key).hide();

          pathMap[key].forEach(path => {
            $('#' + path).click(() => {
              var pickerId = '#color' + key;
              $(pickerId).click();
            })
          });

          $('#color'+key).change(() => {
            var newStyle = "fill:"+$('#color'+key).val()+";fill-opacity:1;fill-rule:nonzero;stroke:none";
            pathMap[key].forEach(path => {
              $('#'+path).attr("style", newStyle);
            });

            if (localStorage.access_token)
              sendUpdate(get01ColorCommand());
            else
              console.log("No access_token!");

          });

        });

        $('#rainbowStart').click(function() {
          var command = get02RainbowCommand(parseInt($('#rainbowWait').val(), 10));
          sendUpdate(command);
        }); 

        $('#colorWipeStart').click(function() {
          var colors = ['#colorWipe1', '#colorWipe2', '#colorWipe3'].map(element => {
            return $(element).val().substring(1);
          });

          var command = get03ColorWipeCommand(parseInt($('#colorWipeWait').val(), 10), colors);
          sendUpdate(command);
        });         

        $('#letterWipeStart').click(function() {
          var colors = ['#letterWipe1', '#letterWipe2', '#letterWipe3'].map(element => {
            return $(element).val().substring(1);
          });

          var command = get04LetterWipeCommand(parseInt($('#letterWipeWait').val(), 10), colors);
          sendUpdate(command);
        }); 

        $('#randomStart').click(function() {
          var command = get05RandomCommand(parseInt($('#randomWait').val(), 10));
          sendUpdate(command);
        }); 

        $('#randomLetterStart').click(function() {
          var command = get06RandomLetterCommand(parseInt($('#randomLetterWait').val(), 10));
          sendUpdate(command);
        });                 


      });

      function sendUpdate(command)
      {
        console.log("update");
        var options = {
          api_base : "https://api.particle.io",
          device_id : "420036000347343138333038"
        };

        var url = options.api_base + "/v1/devices/"+options.device_id+"/mode";
        console.log("POST", url, command);
        $.ajax({
          type: "POST",
          url :  url,
          data : {
            args : command,
            access_token : localStorage.access_token
          },
          success : function (data, textStatus, jqXHR )
          {
            console.log(data);
          },
          error : function (jqXHR, textStatus, errorThrown)
          {
            console.log(errorThrown);
          }
        })
      } 

      function get01ColorCommand()
      {
        var command = "01"; //set color
        Object.keys(pathMap).forEach(key => {
          command += ($('#color'+key).val()).substring(1);
        });

        console.log("ColorCommand is: " + command);
        return command;
      }


      function get02RainbowCommand(wait)
      {
        if (wait < 0 || wait > 255)
          throw new Error("wait is out of range[0,255]");

        var wait = Number(wait).toString(16);
        wait = (wait.length == 1) ? "0" + wait : wait;
        
        var hexString = "02" + wait;
        return hexString;
      }     

      function get03ColorWipeCommand(wait, colors)
      {
        var wait = Number(wait).toString(16);
        wait = (wait.length == 1) ? "0" + wait : wait;

        var hexString = "03";
        hexString += wait;
        hexString += colors.join('');

        return hexString;
      }

      //wait is multiplied by 2 in particle photon
      function get04LetterWipeCommand(wait, colors)
      {
        var wait = Number(wait).toString(16);
        wait = (wait.length == 1) ? "0" + wait : wait;

        var hexString = "04";
        hexString += wait;
        hexString += colors.join('');

        return hexString;
      }

      function get05RandomCommand(wait)
      {
        var wait = Number(wait).toString(16);
        wait = (wait.length == 1) ? "0" + wait : wait;

        var hexString = "05";
        hexString += wait;
        return hexString;
      }  

      function get06RandomLetterCommand(wait)
      {
        var wait = Number(wait).toString(16);
        wait = (wait.length == 1) ? "0" + wait : wait;

        var hexString = "06";
        hexString += wait;
        return hexString;
      }           





      function checkToken()
      {
        if (!localStorage.access_token)
        {
          var access_token = prompt("Please enter the particle API token:", "");
          if (access_token != null)
            localStorage.access_token = access_token;
        }
        else
        {
          console.log("Access Token found!");
        }
      }


    </script>

  </body>
</html>